<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fangspiel Ultimate</title>
<style>
body {
  margin:0; font-family:sans-serif; background: linear-gradient(160deg,#1e3c72,#2a5298); color:#fff; overflow:hidden;
}
canvas { display:block; background:#222; margin:0 auto; }
#score { position:absolute; top:10px; left:50%; transform:translateX(-50%); font-size:24px; color: gold; font-weight:bold; text-shadow:1px 1px 3px black; }
#gameOver { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:rgba(0,0,0,0.8); padding:30px; border-radius:15px; text-align:center; display:none; }
#gameOver button { padding:10px 20px; font-size:16px; margin-top:10px; cursor:pointer; }
footer { position:fixed; bottom:0; width:100%; background: rgba(0,0,0,0.7); padding:10px; text-align:center; font-size:14px; }
footer a { color:#ffd700; text-decoration:none; cursor:pointer; }
.modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.8); color:#fff; padding:20px; overflow:auto; }
.modal h2 { text-align:center; }
.modal button { display:block; margin:20px auto; padding:10px 20px; font-size:16px; cursor:pointer; }
#difficulty { position:absolute; top:50px; left:50%; transform:translateX(-50%); background: rgba(0,0,0,0.5); padding:5px 10px; border-radius:5px; }
</style>
</head>
<body>

<div id="score">Punkte: 0</div>
<div id="difficulty">Schwierigkeit: <span id="diffLevel">1</span></div>
<canvas id="gameCanvas" width="600" height="400"></canvas>

<div id="gameOver">
  <h1>Game Over!</h1>
  <p>Dein Score: <span id="finalScore">0</span></p>
  <button onclick="restartGame()">Nochmal spielen</button>
</div>

<footer>
  <a onclick="showModal('impressum')">Impressum</a> | 
  <a onclick="showModal('datenschutz')">Datenschutzerkl√§rung</a>
</footer>

<div id="impressum" class="modal">
  <h2>Impressum</h2>
  <p>Fangspiel Ultimate ‚Äì erstellt von Kilian üòé</p>
  <button onclick="closeModal()">Schlie√üen</button>
</div>
<div id="datenschutz" class="modal">
  <h2>Datenschutzerkl√§rung</h2>
  <p>Es werden keine pers√∂nlichen Daten gespeichert. Highscores sind lokal und nur f√ºr dein Spiel sichtbar.</p>
  <button onclick="closeModal()">Schlie√üen</button>
</div>

<audio id="catchSound" src="https://freesound.org/data/previews/256/256113_3263906-lq.mp3"></audio>
<audio id="gameOverSound" src="https://freesound.org/data/previews/331/331912_3248244-lq.mp3"></audio>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const catchSound = document.getElementById('catchSound');
const gameOverSound = document.getElementById('gameOverSound');

let player = { x:270, y:360, width:60, height:20 };
let circles = [], confetti = [];
let score = 0, speedMultiplier = 1, gameRunning = true;

function spawnCircle() {
  let x = Math.random() * (canvas.width - 20);
  circles.push({ x: x, y:0, radius:15, speed:2 + Math.random()*2 * speedMultiplier });
}

function drawPlayer() { ctx.fillStyle='#00ffff'; ctx.fillRect(player.x,player.y,player.width,player.height); }
function drawCircles() { ctx.fillStyle='#ffa500'; circles.forEach(c=>{ ctx.beginPath(); ctx.arc(c.x,c.y,c.radius,0,Math.PI*2); ctx.fill(); }); }
function drawConfetti() { confetti.forEach((f,i)=>{ ctx.fillStyle=f.color; ctx.fillRect(f.x,f.y,f.size,f.size); f.y+=f.speed; f.x+=f.dx; f.life--; if(f.life<=0) confetti.splice(i,1); }); }
function createConfetti(x,y){ for(let i=0;i<20;i++){ confetti.push({x:x,y:y,dx:(Math.random()-0.5)*4,speed:2+Math.random()*3,size:4+Math.random()*4,color:['#ff0','#f0f','#0ff','#f00','#0f0'][Math.floor(Math.random()*5)],life:50+Math.random()*50}); } }

function update() {
  circles.forEach((c,i)=>{
    c.y+=c.speed;
    if(c.y+c.radius>player.y && c.x>player.x && c.x<player.x+player.width){
      score++;
      document.getElementById('score').innerText='Punkte: '+score;
      createConfetti(c.x,c.y);
      catchSound.currentTime=0; catchSound.play();
      circles.splice(i,1);
      if(score%5===0){ speedMultiplier+=0.1; document.getElementById('diffLevel').innerText=Math.floor(speedMultiplier*10)/10; }
    } else if(c.y-c.radius>canvas.height){
      gameOver();
    }
  });
}

function gameLoop(){
  if(!gameRunning) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawPlayer();
  drawCircles();
  drawConfetti();
  update();
  requestAnimationFrame(gameLoop);
}

// Steuerung
let keys={};
document.addEventListener('keydown',e=>keys[e.key]=true);
document.addEventListener('keyup',e=>keys[e.key]=false);
function handleKeyboard(){ if(keys['ArrowLeft'] && player.x>0) player.x-=5*speedMultiplier; if(keys['ArrowRight'] && player.x+player.width<canvas.width) player.x+=5*speedMultiplier; }

canvas.addEventListener('mousemove', e=>{
  let rect = canvas.getBoundingClientRect();
  player.x = e.clientX - rect.left - player.width/2;
  if(player.x<0) player.x=0; if(player.x+player.width>canvas.width) player.x=canvas.width-player.width;
});
canvas.addEventListener('touchmove', e=>{
  e.preventDefault();
  let rect = canvas.getBoundingClientRect();
  player.x = e.touches[0].clientX - rect.left - player.width/2;
  if(player.x<0) player.x=0; if(player.x+player.width>canvas.width) player.x=canvas.width-player.width;
},{passive:false});

setInterval(spawnCircle,1000);

function mainLoop(){ handleKeyboard(); gameLoop(); }
requestAnimationFrame(function loop(){ mainLoop(); requestAnimationFrame(loop); });

function gameOver(){
  gameRunning=false;
  document.getElementById('finalScore').innerText=score;
  document.getElementById('gameOver').style.display='block';
  gameOverSound.currentTime=0; gameOverSound.play();
}

function restartGame(){
  circles=[]; confetti=[]; score=0; speedMultiplier=1; gameRunning=true;
  document.getElementById('score').innerText='Punkte: 0';
  document.getElementById('diffLevel').innerText='1';
  document.getElementById('gameOver').style.display='none';
}

function showModal(id){ document.getElementById(id).style.display='block'; }
function closeModal(){ document.querySelectorAll('.modal').forEach(m=>m.style.display='none'); }
</script>

</body>
</html>
